
var game={date:new Date(),phisics:{gravity:0.3,friction:0.8},players:new Array(),objects:new Array(),background:new Array(),objectives:new Array(),creatures:new Array(),collectables:new Array(),screenPlay:null,errorAllowedY:5,errorAllowedX:1,debug:true,debugData:[],endScreen:false,self:this,canvas:null,pauseInput:false,cinematics:false,centered:0,centerVelocity:5,statusGame:null,score:0,activeObjective:null,sceneActions:function(){},colCheck:function(d,c){var b=(d.position.x+(d.width/2))-(c.position.x+(c.width/2)),a=(d.position.y+(d.height/2))-(c.position.y+(c.height/2)),i=(d.width/2)+(c.width/2),g=(d.height/2)+(c.height/2),h=null;if(Math.abs(b)<i&&Math.abs(a)<g){var f=i-Math.abs(b),e=g-Math.abs(a);if(f>=e){if(a>0){h="t";d.position.y+=e}else{h="b";d.position.y-=e}}else{if(b>0){h="l";d.position.x+=f}else{h="r";d.position.x-=f}}}return h},colCheck_temp:function(d,c){var b=(d.position.x+(d.width/2))-(c.position.x+(c.width/2)),a=(d.position.y+(d.height/2))-(c.position.y+(c.height/2)),i=(d.width/2)+(c.width/2),g=(d.height/2)+(c.height/2),h=null;if(Math.abs(b)<i&&Math.abs(a)<g){var f=i-Math.abs(b),e=g-Math.abs(a);if(f>=e){if(a>0){h="t"}else{h="b"}}else{if(b>0){h="l"}else{h="r"}}}return h},drawBackground:function(){for(var a=0;a<this.background.length;a++){this.background[a].animate("")}},drawCreatures:function(){for(var a=0;a<this.creatures.length;a++){this.creatures[a].animate("")}},drawObjects:function(){for(var a=0;a<this.objects.length;a++){this.objects[a].animate("")}},drawCollectables:function(){for(var a=0;a<this.collectables.length;a++){this.collectables[a].animate("")}},drawObjectives:function(){for(var a=0;a<this.objectives.length;a++){this.objectives[a].animate()}},drawCharacters:function(a){for(var b=0;b<this.players.length;b++){this.players[b].animate(a)}},disableInput:function(){game.pauseInput=true;document.body.removeEventListener("keydown",handlerKeyDown);document.body.removeEventListener("keyup",handlerKeyUp)},enableInput:function(){game.pauseInput=false;document.body.addEventListener("keydown",handlerKeyDown);document.body.addEventListener("keyup",handlerKeyUp)},enableMouse:function(){document.body.addEventListener("mousemove",handlerMouseMove);document.body.addEventListener("mousedown",handlerMouseDown);document.body.addEventListener("mouseup",handlerMouseUp)},renderMainScreen:function(){game.canvas.drawImage(library.loadImages.bcgIntro,0,0,game.canvas.container.width,game.canvas.container.height,{});game.canvas.drawImage(library.loadImages.btnStart,300,150,280,96,{});if((input.mouse.clicked===true&&(input.mouse.x>=300&&input.mouse.x<=(300+280))&&(input.mouse.y>=150&&input.mouse.y<=(150+96)))||input.key_code[input.key_enter]===true){cancelAnimationFrame(game.renderMainScreen);requestAnimationFrame(game.render)}else{requestAnimationFrame(game.renderMainScreen)}},render:function(){if(game.statusGame==="terminated"){return false}game.canvas.ctx.clearRect(0,0,game.canvas.container.width,game.canvas.container.height);if(!game.pauseInput&&game.players[0].position.x>game.canvas.container.width*9.2/10&&game.creatures.length==0){game.centered=Math.abs(game.canvas.container.width/2)}if(game.players[0].life<1){game.statusGame="terminated";finishGame(false);return false}$("#lifePlayer").html(game.players[0].life);$("#gameScore").html(game.score);game.drawBackground();game.drawObjects();game.drawCollectables();game.drawCharacters();game.drawCreatures();game.drawObjectives();game.players[0].collidingObjectives();if(game.activeObjective!==null){game.getObjective(game.activeObjective).doObjectives()}game.players[0].collidingCreatures();game.sceneActions();game.clearFinishedObjectives();game.centerAll();requestAnimationFrame(game.render)},addPlayer:function(a){this.players.push(a)},addObject:function(a){this.objects.push(a)},addCollectable:function(a){this.collectables.push(a)},addBackground:function(a){this.background.push(a)},addObjective:function(a){this.objectives.push(a)},addCreature:function(a){this.creatures.push(a)},setCanvas:function(a){this.canvas=a},removeCreature:function(b){for(var a=0;a<game.creatures.length;a++){if(game.creatures[a].id==b){if(typeof(game.creatures[a].objectives.onDie)==="function"){game.creatures[a].objectives.onDie()}game.creatures.splice(a,1);return true}}return false},removeCollectable:function(b){for(var a=0;a<game.collectables.length;a++){if(game.collectables[a].id==b){game.collectables.splice(a,1);return true}}return false},getObjective:function(b){for(var a=0;a<game.objectives.length;a++){if(game.objectives[a].id==b){return game.objectives[a]}}return false},getCreatureByName:function(a){for(var b=0;b<game.creatures.length;b++){if(game.creatures[b].name==a){return game.creatures[b]}}return false},doCinematics:function(){},centerAll:function(){if(game.centered>0){this.centered-=3}},clearFinishedObjectives:function(){for(var a=0;a<this.objectives.length;a++){if(this.objectives[a].finish){game.objectives[a].doObjectives();game.objectives.splice(a,1)}}}};